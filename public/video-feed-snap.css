/**
 * VIDEO FEED SNAP SCROLLING
 * TikTok/Reels-Style für alle Browser
 * Funktioniert auf Mobile, Tablet, Laptop und Desktop
 */

/* ============================
   SCROLL CONTAINER
   ============================ */

/* Root Container für Feed */
body,
#root,
[data-expo-root] {
  overflow: hidden;
  height: 100vh;
  height: -webkit-fill-available;
}

/* FlatList / ScrollView Container */
.scrollview-content-container,
[data-testid="flat-list"] {
  /* CSS Scroll Snap - MANDATORY für 1:1 Paging */
  scroll-snap-type: y mandatory;
  
  /* Smooth Scrolling */
  scroll-behavior: smooth;
  
  /* Verhindert Überscrollen */
  overscroll-behavior-y: contain;
  
  /* iOS Safari: Touch Momentum */
  -webkit-overflow-scrolling: touch;
  
  /* Performance Optimierung */
  will-change: scroll-position;
  transform: translateZ(0);
  
  /* Volle Höhe */
  height: 100vh;
  height: -webkit-fill-available;
  
  /* Verstecke Scrollbar */
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.scrollview-content-container::-webkit-scrollbar,
[data-testid="flat-list"]::-webkit-scrollbar {
  display: none;
}

/* ============================
   VIDEO ITEMS (Snap Points)
   ============================ */

/* Jedes Video ist ein Snap-Punkt */
.video-item,
[data-video-item="true"],
div[style*="height: 100vh"] {
  /* CRITICAL: Snap Alignment */
  scroll-snap-align: start;
  scroll-snap-stop: always;
  
  /* Volle Viewport-Höhe */
  height: 100vh !important;
  min-height: 100vh !important;
  max-height: 100vh !important;
  
  /* iOS Safari Fix */
  height: -webkit-fill-available !important;
  min-height: -webkit-fill-available !important;
  max-height: -webkit-fill-available !important;
  
  /* Volle Breite */
  width: 100vw;
  
  /* Verhindert Teilansichten */
  position: relative;
  
  /* Performance */
  contain: layout style paint;
  
  /* Hardware Acceleration */
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* ============================
   BROWSER-SPEZIFISCHE FIXES
   ============================ */

/* Chrome & Edge: Snap-Punkte präzisieren */
@supports (-webkit-appearance: none) {
  .video-item,
  [data-video-item="true"] {
    scroll-snap-align: start;
    scroll-snap-stop: always;
  }
}

/* Firefox: Snap-Behavior */
@supports (-moz-appearance: none) {
  .scrollview-content-container {
    scroll-snap-type: y mandatory;
    scroll-padding: 0;
  }
}

/* Safari: iOS & macOS */
@supports (-webkit-touch-callout: none) {
  .scrollview-content-container {
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: y mandatory;
  }
  
  .video-item,
  [data-video-item="true"] {
    /* Verhindert Bounce zwischen Videos */
    scroll-snap-stop: always;
  }
}

/* ============================
   TOUCH OPTIMIZATION
   ============================ */

/* Swipe-Gesten optimieren */
@media (hover: none) and (pointer: coarse) {
  .scrollview-content-container {
    /* Schnelleres Deceleration für Mobile */
    scroll-behavior: smooth;
    
    /* Touch-Optimierung */
    touch-action: pan-y;
    -webkit-user-select: none;
    user-select: none;
  }
}

/* Desktop: Mausrad-Optimierung */
@media (hover: hover) and (pointer: fine) {
  .scrollview-content-container {
    /* Sanfteres Scrolling mit Mausrad */
    scroll-behavior: smooth;
  }
}

/* ============================
   RESPONSIVE ANPASSUNGEN
   ============================ */

/* Mobile: Smartphone (Portrait) */
@media (max-width: 767px) and (orientation: portrait) {
  .video-item,
  [data-video-item="true"] {
    height: 100vh !important;
    height: calc(var(--vh, 1vh) * 100) !important;
  }
}

/* Tablet: iPad, Android Tablets */
@media (min-width: 768px) and (max-width: 1023px) {
  .video-item,
  [data-video-item="true"] {
    height: 100vh !important;
  }
}

/* Laptop & Desktop */
@media (min-width: 1024px) {
  .video-item,
  [data-video-item="true"] {
    height: 100vh !important;
    max-width: 100vw;
  }
}

/* ============================
   LANDSCAPE MODE
   ============================ */

@media (orientation: landscape) and (max-height: 768px) {
  .video-item,
  [data-video-item="true"] {
    /* Landscape: Volle Höhe nutzen */
    height: 100vh !important;
    width: 100vw !important;
  }
}

/* ============================
   FOLDABLE DEVICES
   ============================ */

/* Samsung Galaxy Fold, Z Flip etc. */
@media (min-width: 653px) and (max-width: 717px) {
  .video-item,
  [data-video-item="true"] {
    height: 100vh !important;
  }
}

/* ============================
   PERFORMANCE & ANTI-FLICKER
   ============================ */

/* Verhindert Flackern beim Scrollen */
.video-item video,
[data-video-item="true"] video {
  /* Hardware Acceleration */
  transform: translateZ(0);
  -webkit-transform: translateZ(0);
  
  /* Smooth Rendering */
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  
  /* Optimierte Darstellung */
  will-change: transform;
}

/* ============================
   ACCESSIBILITY
   ============================ */

/* Reduced Motion: Deaktiviere Smooth Scroll */
@media (prefers-reduced-motion: reduce) {
  .scrollview-content-container {
    scroll-behavior: auto;
  }
}

/* ============================
   DEBUG (Entwicklung)
   ============================ */

/* Aktiviere bei Bedarf für Debugging */
/*
.video-item,
[data-video-item="true"] {
  border: 2px solid red;
  box-sizing: border-box;
}

.scrollview-content-container {
  border: 3px solid blue;
}
*/
